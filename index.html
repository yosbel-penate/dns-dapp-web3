<head>
        <link
        href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css"
        rel="stylesheet"
        />
        <link rel="shortcut icon" href="https://img.icons8.com/color/96/000000/administrative-tools.png">
        <script
        src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.6.1/web3.min.js"
        integrity="sha512-5erpERW8MxcHDF7Xea9eBQPiRtxbse70pFcaHJuOhdEBQeAxGQjUwgJbuBDWve+xP/u5IoJbKjyJk50qCnMD7A=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
        ></script>
    </head>

    <body class="h-full">
        <div
        class="
            flex
            w-full
            h-full
            justify-center
            content-center
            items-center
            space-x-4
        "
        >
        <div class="flex flex-col space-y-6 m-100">
            <br/>
            <button
                id="copyContractAddress"
                onclick="copy()"
                class="rounded bg-blue-500 hover:bg-blue-700 py-2 px-4 text-white inline-flex items-center"
                >
                <span id="spanCopyContractAddress">Contract: ---</span>
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
            </button>
            <div class="flex flex-col space-y-2">
                <div class="container flex justify-center mx-auto">
                    <div class="flex flex-col">
                        <div class="w-full">
                            <div class="border-b border-gray-200 shadow">
                                <table>
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-2 text-xs text-gray-500">
                                                Information
                                            </th>
                                            <th class="px-6 py-2 text-xs text-gray-500">
                                                Value
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white">
                                        <tr class="whitespace-nowrap">
                                            <td class="px-6 py-4 text-sm text-gray-500">
                                                Owner
                                            </td>
                                            <td class="px-6 py-4">
                                                <div id="ownerValueText" class="text-sm text-gray-900">
                                                    Jon doe
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="whitespace-nowrap">
                                            <td class="px-6 py-4 text-sm text-gray-500">
                                                Balance
                                            </td>
                                            <td class="px-6 py-4">
                                                <div id="getBalanceText" class="text-sm text-gray-900">
                                                    Jon doe
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="whitespace-nowrap">
                                            <td class="px-6 py-4 text-sm text-gray-500">
                                                Total Supply
                                            </td>
                                            <td class="px-6 py-4">
                                                <div id="totalSupplyText" class="text-sm text-gray-900">
                                                    Jon doe
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            <button
                id="getContractInfo"
                onclick="getContractSymbol()"
                class="rounded place-content-center bg-blue-500 hover:bg-blue-700 py-2 px-4 text-white inline-flex items-center"
                >
                <span>Refresh Contract Symbol</span>
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
            </button>
            <button
                onclick="loginWithEth()"
                class="
                rounded
                bg-white
                border border-gray-400
                hover:bg-gray-100
                py-2
                px-4
                text-gray-600
                hover:text-gray-700
                "
            >
                Login & Save ETH Address
            </button>
            <p id="userAddress" class="text-gray-600"></p>
            <button
                id="logoutButton"
                onclick="logout()"
                class="hidden text-blue-500 underline"
            >
                Logout
            </button>
            </div>
            <button
                onclick="deposit_onclick()"
                class="rounded bg-blue-500 hover:bg-blue-700 py-2 px-4 text-white inline-flex items-center"
                >
                <span id="depositButton">Deposit: ---</span>
            </button>
            <div class="w-full">
                <form class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                    <div class="mb-4 flex">
                        <input  id="setURL" type="text" placeholder="Set URL" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <button onclick="setURL_onclick()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 ml-2 rounded focus:outline-none focus:shadow-outline" type="button">
                            Call
                        </button>
                    </div>
                    <div class="mb-4 flex">
                        <input  id="nameExist" type="text" placeholder="Exist URL?" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <button
                                onclick="nameExist_onclick()"
                                class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 ml-2 rounded focus:outline-none focus:shadow-outline"
                                type="button"
                            >
                            Call
                        </button>
                    </div>
                    <div class="mb-4 flex">
                        <input  id="URLs" type="text" placeholder="URL List" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 ml-2 rounded focus:outline-none focus:shadow-outline" type="button"
                            onclick="getURLs()" 
                        >
                            Call
                        </button>
                    </div>
                </form>
            </div>
            <div class="flex flex-col space-y-2"></div>
        </div>
        </div>
        <script>
            window.userAddress = null;
            window.CONTRACT_ADDRESS='0xf86415cEEeb46C95A4BB741f536513a7b5BC2BE3';
            window.handlerCost=1800000000000000;
            window.onload =  async ()=>{
                if(window.ethereum){
                    window.web3=new Web3(ethereum);
                    try{
                        await ethereum.enable();
                        await getContractSymbol();
                    }
                    catch(error){
                        console.error(error);
                    }
                }
                else{
                    alert('No ether browser externsion detected.')
                }
                window.userAddress = window.localStorage.getItem('userAddress');
                showAddress();
            }
            function showAddress(){
                if(!window.userAddress) {
                    document.getElementById('userAddress').innerText = null;
                    document.getElementById('logoutButton').classList.add('hidden');
                    return false;
                }
                else{
                    document.getElementById('userAddress').innerText = `ETH address: ${window.userAddress}`;
                    document.getElementById('logoutButton').classList.remove('hidden');
                };
            }
            function logout(){
                window.userAddress=null;
                window.localStorage.removeItem('userAddress');
                showAddress();
            }
            async function loginWithEth(){
                if(window.web3){
                    try{
                        const accounts=await web3.eth.getAccounts();
                        window.userAddress=accounts[0];
                        window.localStorage.setItem('userAddress', accounts[0]);
                        showAddress();
                    }
                    catch(error){
                        console.error(error);
                    }
                }
                else {
                    alert('No ether browser externsion detected.')
                }
            }
            async function copy(){
                navigator.clipboard.writeText(window.CONTRACT_ADDRESS);
                alert(window.CONTRACT_ADDRESS);
            }
            async function getContractSymbol(){
                const contract = new window.web3.eth.Contract(window.ABI, window.CONTRACT_ADDRESS);
                //--Data from contract
                const ownerValue = await contract.methods.owner().call({from: window.userAddress});
                const getBalanceValue = await contract.methods.getBalance().call({from: window.userAddress});
                const totalSupplyValue = await contract.methods.totalSupply().call({from: window.userAddress});
                //--Show information
                document.getElementById('ownerValueText').innerHTML = ownerValue;
                document.getElementById('getBalanceText').innerHTML = getBalanceValue;
                document.getElementById('totalSupplyText').innerHTML = totalSupplyValue;
                document.getElementById('depositButton').innerHTML="Deposit: " + window.handlerCost;
                document.getElementById('spanCopyContractAddress').innerHTML="Contract: " + window.CONTRACT_ADDRESS;
            }
            async function setURL_onclick(){
                const contract = new window.web3.eth.Contract(window.ABI, window.CONTRACT_ADDRESS);
                const setURLText = document.getElementById('setURL').value;
                if(!isEmpty(setURLText) && !hasWhiteSpace(setURLText)){
                    try{
                        await contract.methods.setURL(setURLText).send({from: window.userAddress});
                    }catch(error){
                        console.log(error);
                    }
                }
                else{
                    alert("Provide some name.");
                }
                document.getElementById('setURL').value = null;
            }
            async function deposit_onclick(){
                const contract = new window.web3.eth.Contract(window.ABI, window.CONTRACT_ADDRESS);
                try{
                    await contract.methods.deposit().send({from: window.userAddress, value: window.handlerCost});
                    await getContractSymbol();
                }catch(error){
                    console.log(error);
                }
            }
            async function nameExist_onclick(){
                const contract = new window.web3.eth.Contract(window.ABI, window.CONTRACT_ADDRESS);
                const nameExistText = document.getElementById('nameExist').value;
                var existName = await contract.methods.nameExist(nameExistText).call({from: window.userAddress});
                if(existName){
                    alert(nameExistText + " exist.");
                }
                else{
                    alert(nameExistText + " not exist.");
                }
                document.getElementById('nameExist').value = null;
            }
            function isEmpty(str) {
                return (!str || str.length === 0 );
            }
            function hasWhiteSpace(s) {
                return s.indexOf(' ') >= 0;
            }
            async function getURLs(){
                const contract = new window.web3.eth.Contract(window.ABI, window.CONTRACT_ADDRESS);
                const URLs = await contract.methods.getURLs().call({from: window.userAddress});
                document.getElementById('URLs').value = URLs;

            }
            window.ABI=[{"inputs":[],"stateMutability":"payable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"balance","type":"uint256"}],"name":"Deposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"totalSupply","type":"uint256"}],"name":"WithdrawBalance","type":"event"},{"stateMutability":"payable","type":"fallback"},{"inputs":[{"internalType":"string","name":"_urlName","type":"string"}],"name":"deleteURLs","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"deposit","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_urlName","type":"string"}],"name":"getOnions","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getURLs","outputs":[{"internalType":"string[]","name":"","type":"string[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"handlingCost","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"nameExist","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address payable","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_urlName","type":"string"},{"internalType":"string[]","name":"_onions","type":"string[]"}],"name":"setOnions","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_urlName","type":"string"}],"name":"setURL","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_to","type":"address"},{"internalType":"string","name":"_urlName","type":"string"}],"name":"transferURLs","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawBalance","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawSurplus","outputs":[],"stateMutability":"nonpayable","type":"function"}];
        </script>
</body>